# API Contracts: Подключение фронтенда к API дилемм

**Feature**: `001-connect-backend`  
**Source of truth**: `specs/001-dilemma-system/contracts/api-spec.json`

Этот feature использует уже существующий OpenAPI‑контракт системы дилем и не изменяет структуру backend‑API. Ниже перечислены группы эндпоинтов, от которых зависит фронтенд.

---

## 1. Дилемы

- **Список дилем**  
  - Method: `GET`  
  - Path: `/api/dilemmas`  
  - Purpose: загрузка списка активных дилем для экрана выбора.

- **Детали дилемы**  
  - Method: `GET`  
  - Path: `/api/dilemmas/{name}`  
  - Purpose: получение полного описания дилемы и статуса участия пользователя.

---

## 2. Решения пользователя

- **Первоначальный выбор (initial choice)**  
  - Method: `POST`  
  - Path: `/api/decisions/initial`  
  - Headers: `X-User-UUID: <uuid>`  
  - Purpose: зафиксировать первый выбор (A/B) и получить фидбэк‑текст.

- **Финальное решение (final choice)**  
  - Method: `POST`  
  - Path: `/api/decisions/final`  
  - Headers: `X-User-UUID: <uuid>`  
  - Purpose: зафиксировать финальное решение и получить обновлённое состояние траектории.

- **История решений пользователя**  
  - Method: `GET`  
  - Path: `/api/decisions/my`  
  - Headers: `X-User-UUID: <uuid>`  
  - Purpose: загрузка списка всех дилем, в которых участвовал текущий пользователь.

---

## 3. Статистика

- **Статистика по дилеме**  
  - Method: `GET`  
  - Path: `/api/statistics/dilemma/{name}`  
  - Purpose: агрегированная статистика по траекториям AA/AB/BB/BA, времени и количеству участников.

---

## 4. Пользователи (для административных экранов)

- **Список пользователей**  
  - Method: `GET`  
  - Path: `/api/users`  
  - Purpose: административный просмотр списка пользователей (может использоваться для отдельных экранов аналитики).

---

## 5. Консистентность с OpenAPI

Для любой доработки, затрагивающей эти эндпоинты:

- сначала обновляется основной контракт `specs/001-dilemma-system/contracts/api-spec.json`;  
- затем при необходимости обновляется это описание (подмножество) и фронтенд‑логика, использующая эндпоинты.

